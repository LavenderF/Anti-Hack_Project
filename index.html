<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>文字燃烧动画效果</title>
<style>
  body {
    background: #1a1a1a;
    color: #f5f0e6;
    font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
    padding: 20px;
    user-select: none;
  }
  textarea {
    width: 100%;
    height: 100px;
    font-size: 24px;
    padding: 10px;
    margin-bottom: 12px;
    border-radius: 6px;
    border: 1px solid #ccc;
    resize: vertical;
  }
  #burnContainer {
    font-size: 32px;
    line-height: 1.3;
    letter-spacing: 0.04em;
    white-space: pre-wrap;
    word-break: break-word;
    min-height: 100px;
  }
  #burnContainer span {
    display: inline-block;
    transition: none;
    cursor: default;
    position: relative;
  }
  /* 火光光晕效果 */
  .fire-glow::after {
    content: "";
    position: absolute;
    top: 50%;
    left: 50%;
    width: 120%;
    height: 120%;
    pointer-events: none;
    transform: translate(-50%, -50%);
    border-radius: 50%;
    box-shadow:
      0 0 8px 2px rgba(255, 150, 50, 0.8),
      0 0 15px 5px rgba(255, 100, 0, 0.7),
      0 0 30px 10px rgba(255, 70, 0, 0.6);
    animation: flicker 1.2s infinite alternate;
  }
  @keyframes flicker {
    0% { box-shadow:
      0 0 6px 1.5px rgba(255, 180, 70, 0.9),
      0 0 14px 4px rgba(255, 120, 20, 0.8),
      0 0 28px 8px rgba(255, 90, 0, 0.7); }
    100% { box-shadow:
      0 0 12px 3px rgba(255, 200, 80, 1),
      0 0 18px 7px rgba(255, 150, 40, 0.9),
      0 0 38px 14px rgba(255, 120, 10, 0.8); }
  }

  /* 粒子样式 */
  .particle {
    position: fixed;
    pointer-events: none;
    border-radius: 50%;
    opacity: 1;
    mix-blend-mode: screen;
  }

  button {
    padding: 10px 18px;
    font-size: 18px;
    margin-right: 10px;
    border-radius: 5px;
    border: none;
    cursor: pointer;
    background: #ff6600;
    color: white;
    transition: background-color 0.3s ease;
  }
  button:disabled {
    background: #aaa;
    cursor: not-allowed;
  }
  button:hover:not(:disabled) {
    background: #ff8844;
  }
  #futureDiv {
    margin-top: 20px;
    font-size: 20px;
    color: #ffb366;
    min-height: 40px;
  }
</style>
</head>
<body>
<h2>文字燃烧动画（随机字母慢慢燃烧，燃烧后字母透明占位）</h2>
<textarea id="inputArea" placeholder="请输入你想燃烧的文字...">燃烧吧，文字！🔥🔥🔥</textarea><br />
<button id="burnBtn">开始燃烧🔥</button>
<button id="saveFutureBtn" disabled>保存结果</button>

<div id="burnContainer"></div>
<div id="futureDiv"></div>

<script>
  const area = document.getElementById("inputArea");
  const burnBtn = document.getElementById("burnBtn");
  const saveFutureBtn = document.getElementById("saveFutureBtn");
  const burnContainer = document.getElementById("burnContainer");
  const futureDiv = document.getElementById("futureDiv");

  let toBurn = [];
  let burningIndex = 0;
  let baseDelay = 600; // 初始燃烧间隔 ms
  const minDelay = 100; // 最快燃烧间隔
  const acceleration = 0.75; // 每次加速乘数（越小加速越快）

  // 粒子系统
  const particles = [];
  const particleColors = ["#ff6600", "#ff9933", "#ffcc66", "#ff3300"];
  const maxParticleSize = 8;

  function createParticle(x, y) {
    const p = document.createElement("div");
    p.className = "particle";
    p.style.backgroundColor = particleColors[Math.floor(Math.random() * particleColors.length)];
    const size = Math.random() * maxParticleSize + 3;
    p.style.width = size + "px";
    p.style.height = size + "px";
    p.style.left = x + "px";
    p.style.top = y + "px";
    p.vx = (Math.random() - 0.5) * 2;
    p.vy = -Math.random() * 3 - 1;
    p.life = 40 + Math.random() * 20;
    p.style.opacity = 1;
    document.body.appendChild(p);
    particles.push(p);
  }

  function animateParticles() {
    for(let i = particles.length - 1; i >= 0; i--) {
      const p = particles[i];
      p.life--;
      if (p.life <= 0) {
        p.remove();
        particles.splice(i,1);
        continue;
      }
      p.vx *= 0.95;
      p.vy += 0.1; // 重力感
      let left = parseFloat(p.style.left);
      let top = parseFloat(p.style.top);
      left += p.vx;
      top += p.vy;
      p.style.left = left + "px";
      p.style.top = top + "px";
      p.style.opacity = p.life / 60;
    }
    if(particles.length > 0){
      requestAnimationFrame(animateParticles);
    }
  }

  function startBurn() {
    burnBtn.disabled = true;
    saveFutureBtn.disabled = true;
    futureDiv.innerText = "";
    burnContainer.innerHTML = "";

    const text = area.value;
    if(!text.trim()){
      alert("请输入一些文字");
      burnBtn.disabled = false;
      return;
    }

    // 将文字拆成span，方便单独控制
    toBurn = [];
    for(let ch of text){
      const span = document.createElement("span");
      span.innerText = ch;
      span.classList.add("fire-glow");
      burnContainer.appendChild(span);
      toBurn.push(span);
    }
    burningIndex = 0;
    baseDelay = 600;

    // 随机打乱燃烧顺序索引
    shuffleArray(toBurn);

    // 让textarea隐藏，避免重复输入
    area.style.display = "none";

    burnNext();
  }

  function burnNext(){
    if(burningIndex >= toBurn.length){
      setTimeout(() => {
        burnContainer.innerHTML = '';
        futureDiv.innerText = "🕊️ 它已经不在这里了。你做得很好。";
        burnBtn.disabled = false;
        saveFutureBtn.disabled = false;
        area.value = '';
        area.style.display = 'block';
        area.disabled = false;
      }, 1500);
      return;
    }
    const span = toBurn[burningIndex];
    burningIndex++;

    const rect = span.getBoundingClientRect();
    for(let i=0; i<4; i++){
      createParticle(rect.left + rect.width/2, rect.top + rect.height/2);
    }
    if(particles.length > 0) animateParticles();

    let opacity = 1;
    let brightness = 1;
    let saturate = 1;
    let skewX = 0;
    let skewY = 0;
    let scale = 1;
    let rotate = 0;
    let frame = 0;

    function animate(){
      frame++;
      opacity -= 0.03;
      brightness -= 0.02;
      saturate -= 0.015;
      skewX = Math.sin(frame * 0.3) * 10;
      skewY = Math.cos(frame * 0.2) * 6;
      scale -= 0.01;
      rotate += 1;

      span.style.opacity = opacity < 0 ? 0 : opacity;
      span.style.filter = `brightness(${brightness < 0 ? 0 : brightness}) saturate(${saturate < 0 ? 0 : saturate}) blur(${(1 - opacity)*3}px)`;
      span.style.transform = `skew(${skewX}deg, ${skewY}deg) scale(${scale < 0 ? 0 : scale}) rotate(${rotate}deg)`;

      if(opacity <= 0){
        // 保留位置，只透明不可见
        span.style.visibility = 'hidden'; 
        span.classList.remove('fire-glow');
        span.style.opacity = 0;
        span.style.pointerEvents = 'none';

        baseDelay = Math.max(minDelay, baseDelay * acceleration);
        setTimeout(burnNext, baseDelay);
      } else {
        requestAnimationFrame(animate);
      }
    }
    animate();
  }

  // Fisher-Yates 洗牌算法随机打乱数组
  function shuffleArray(array){
    for(let i=array.length-1; i>0; i--){
      const j = Math.floor(Math.random()*(i+1));
      [array[i], array[j]] = [array[j], array[i]];
    }
  }

  burnBtn.onclick = startBurn;
  saveFutureBtn.onclick = () => {
    const text = burnContainer.innerText;
    navigator.clipboard.writeText(text).then(() => {
      alert("燃烧后的文字已复制到剪贴板！");
    }).catch(() => {
      alert("复制失败，请手动复制！");
    });
  };
</script>
</body>
</html>
