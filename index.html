<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>é—å¿˜å›¾ä¹¦é¦† â€” é€å­—ç‡ƒçƒ§åŠ¨ç”»å¸¦ç«å…‰</title>
<style>
  body {
    margin:0; padding:40px 20px 100px;
    background: #1c1c1c;
    color: #f0e6d2;
    font-family: 'Courier New', monospace;
    display: flex; flex-direction: column; align-items: center;
    min-height: 100vh;
    overflow-x: hidden;
    user-select: none;
  }
  h1 {
    margin-bottom: 10px;
  }
  textarea {
    width: 90%;
    max-width: 600px;
    height: 180px;
    padding: 15px;
    font-size: 16px;
    background: #2b2b2b;
    color: #f0e6d2;
    border: none;
    resize: none;
  }
  button {
    margin: 15px 10px 0 0;
    background: #ff5722;
    color: white;
    padding: 10px 22px;
    font-size: 16px;
    border: none;
    cursor: pointer;
    border-radius: 6px;
    transition: background 0.3s;
    position: relative;
  }
  button:hover {
    background: #e04e1f;
  }
  #futureMessage {
    margin-top: 25px;
    font-size: 16px;
    color: #aaa;
    max-width: 600px;
    text-align: center;
    white-space: pre-wrap;
  }
  #burnContainer p {
    margin: 6px 0;
    font-size: 18px;
    font-weight: bold;
  }
  #burnContainer p span {
    display: inline-block;
    position: relative;
  }
  /* ç«å…‰åŠ¨ç”» */
  @keyframes fireGlow {
    0%, 100% { text-shadow: 
      0 0 6px #ff5722,
      0 0 10px #ff7043,
      0 0 18px #ff8a65,
      0 0 30px #ffab91; 
    }
    50% { text-shadow:
      0 0 12px #ff7043,
      0 0 20px #ff5722,
      0 0 25px #ff8a65,
      0 0 40px #ffab91;
    }
  }
  /* ç‡ƒçƒ§ä¸­çš„å­—ç«å…‰ */
  .burning {
    animation: fireGlow 1s infinite alternate;
  }
  /* ç‡ƒçƒ§æ–‡å­—åŠ¨ç”» */
  .burn-char {
    opacity: 1;
    filter: blur(0);
    transform: translate(0,0) rotate(0deg);
    transition: none;
  }
  /* ç‡ƒçƒ§æ¶ˆå¤±çŠ¶æ€ */
  .burned {
    opacity: 0 !important;
    filter: blur(2px);
    pointer-events: none;
    transform: translate(0, 5px) rotate(20deg);
  }

  /* åº•éƒ¨å“²æ€ */
  #philosophy {
    position: fixed;
    bottom: 20px;
    width: 100%;
    text-align: center;
    font-size: 14px;
    color: #999;
    font-style: italic;
    user-select: none;
    pointer-events: none;
    height: 20px;
    line-height: 20px;
  }
</style>
</head>
<body>

<h1>å†™ä¸‹ä½ æƒ³è¢«é—å¿˜çš„äº‹</h1>
<textarea id="confession" placeholder="åœ¨è¿™é‡Œå†™ä¸‹â€¦â€¦"></textarea>
<div>
  <button id="burnBtn" title="çƒ§æ‰å®ƒ">ğŸ”¥ çƒ§æ‰å®ƒ</button>
  <button id="saveFutureBtn" title="å†™ç»™æœªæ¥">ğŸ’Œ å†™ç»™æœªæ¥</button>
</div>
<div id="futureMessage"></div>
<div id="burnContainer"></div>
<div id="philosophy"></div>

<script>
(() => {
  const area = document.getElementById('confession');
  const burnBtn = document.getElementById('burnBtn');
  const saveFutureBtn = document.getElementById('saveFutureBtn');
  const futureDiv = document.getElementById('futureMessage');
  const burnContainer = document.getElementById('burnContainer');
  const philosophy = document.getElementById('philosophy');

  // å“²æ€è¯­å½•
  const quotes = [
    "å¤±å»æœªå¿…æ˜¯æŸè€—ï¼Œæ”¾ä¸‹ä¹Ÿå¯èƒ½æ˜¯æˆå…¨ã€‚",
    "æ¯ä¸€æ¬¡ç„šçƒ§ï¼Œéƒ½æ˜¯æ–°çš„å¼€å§‹ã€‚",
    "è½»è½»æ”¾ä¸‹ï¼Œæ˜¯ç»™è‡ªå·±æœ€å¤§çš„æ…ˆæ‚²ã€‚",
    "è®°å¿†å¦‚ç°çƒ¬ï¼Œç»ˆä¼šéšé£è¿œå»ã€‚",
    "ç—›è‹¦ä¸ä¼šæ°¸è¿œåœç•™ï¼Œæ­£å¦‚ç«ç„°ç»ˆå°†ç†„ç­ã€‚",
    "é—å¿˜æ˜¯ä¸€ç§æ¸©æŸ”çš„è§£è„±ã€‚",
    "å…è®¸è‡ªå·±æ”¾ä¸‹ï¼Œæ‰èƒ½çœ‹è§æ›´è¿œçš„é£æ™¯ã€‚",
    "è¿‡å»ä¸å†é‡æ¥ï¼Œæœªæ¥ä»æ­¤å±•å¼€ã€‚"
  ];
  let quoteIndex = 0;

  // å“²æ€è½®æ’­
  function showNextQuote(){
    philosophy.style.opacity = 0;
    setTimeout(() => {
      philosophy.textContent = quotes[quoteIndex];
      philosophy.style.opacity = 1;
      quoteIndex = (quoteIndex +1) % quotes.length;
    }, 800);
  }
  showNextQuote();
  setInterval(showNextQuote, 15000);

  // æ¢å¤æœªæ¥ç•™è¨€ï¼ˆsessionStorageï¼Œä¸€æ¬¡æ€§ï¼‰
  window.onload = () => {
    // æ¢å¤æœªæ¥ç•™è¨€
    const msg = sessionStorage.getItem('future');
    if (msg) {
      futureDiv.innerText = "ğŸ“¬ æ¥è‡ªè¿‡å»çš„ä½ å†™é“ï¼š\n" + msg;
      sessionStorage.removeItem('future');
    }
  };

  // ä¿å­˜æœªæ¥ç•™è¨€ï¼ˆä¸€æ¬¡æ€§ï¼ŒsessionStorageï¼‰
  saveFutureBtn.onclick = () => {
    const msg = prompt("å†™ä¸€å¥è¯ç»™æœªæ¥çš„è‡ªå·±ï¼š");
    if (msg && msg.trim()) {
      sessionStorage.setItem('future', msg.trim());
      alert("âœ… å·²ä¿å­˜ç»™æœªæ¥çš„ä½ ã€‚åˆ·æ–°æˆ–å…³é—­é¡µé¢åæ‰ä¼šçœ‹åˆ°ã€‚");
    }
  };

  // ç‡ƒçƒ§åŠ¨ç”»å‡½æ•°
  burnBtn.onclick = () => {
    if (area.style.display === 'none') return; // é˜²æ­¢é‡å¤ç‚¹
    const text = area.value.trim();
    if (!text) return alert('è¯·è¾“å…¥å†…å®¹åå†çƒ§æ‰å®ƒã€‚');
    burnBtn.disabled = true;
    saveFutureBtn.disabled = true;
    area.disabled = true;

    const lines = text.split('\n');
    area.style.display = 'none';
    burnContainer.innerHTML = '';

    // æ¯è¡Œåˆ†å‰²æˆå•å­—ç¬¦spanï¼Œæ·»åŠ ç‡ƒçƒ§åˆå§‹æ ·å¼
    lines.forEach(line => {
      const p = document.createElement('p');
      for (const ch of line) {
        const span = document.createElement('span');
        span.textContent = ch;
        span.classList.add('burn-char');
        p.appendChild(span);
      }
      burnContainer.appendChild(p);
    });

    const paragraphs = burnContainer.querySelectorAll('p');
    let lineIndex = 0;

    function burnLine() {
      if (lineIndex >= paragraphs.length) {
        // å…¨éƒ¨çƒ§å®Œ
        setTimeout(() => {
          burnContainer.innerHTML = '';
          futureDiv.innerText = "ğŸ•Šï¸ å®ƒå·²ç»ä¸åœ¨è¿™é‡Œäº†ã€‚ä½ åšå¾—å¾ˆå¥½ã€‚";
          burnBtn.disabled = false;
          saveFutureBtn.disabled = false;
          area.value = '';
          area.style.display = 'block';
          area.disabled = false;
        }, 1000);
        return;
      }
      const spans = paragraphs[lineIndex].querySelectorAll('span');
      let charIndex = 0;

      function burnChar() {
        if (charIndex >= spans.length) {
          lineIndex++;
          setTimeout(burnLine, 400);
          return;
        }
        const span = spans[charIndex];
        span.classList.add('burning'); // å¼€å§‹ç«å…‰åŠ¨ç”»
        let opacity = 1;
        let frame = 0;

        function animate() {
          opacity -= 0.04;
          frame++;
          span.style.opacity = opacity;
          const shakeX = Math.sin(frame * 0.5) * 2 + 'px';
          const shakeY = Math.cos(frame * 0.3) * 1 + 'px';
          const rotateDeg = (frame * 5) % 360;
          const blurPx = (1 - opacity) * 3 + 'px';
          span.style.transform = `translate(${shakeX},${shakeY}) rotate(${rotateDeg}deg)`;
          span.style.filter = `blur(${blurPx})`;
          if (opacity <= 0) {
            span.style.display = 'none';
            span.classList.remove('burning');
            charIndex++;
            setTimeout(burnChar, 100);
          } else {
            requestAnimationFrame(animate);
          }
        }
        animate();
      }
      burnChar();
    }
    burnLine();
  };

})();
</script>

</body>
</html>

